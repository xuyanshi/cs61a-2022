
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="description" content ="CS 61A: Structure and Interpretation of Computer Programs" />
    <meta name="keywords" content ="CS 61A, Computer Science, CS, 61A, Programming, John DeNero, Berkeley, EECS" />
    <meta name="author" content ="John DeNero, Justin Yokota" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-throttle-debounce/1.1/jquery.ba-throttle-debounce.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="/assets/js/hl.js"></script>
    <script src="/assets/js/toggledarkmode.js"></script>
    <script>
        // we aren't registering builtins since
        //      (1) they don't render differently in the current CSS from other names
        //      (2) it's a mess to list all of them. You can extract from the site but that takes effort
        // if (1) ceases to be true, (2) might be worth the effort. For now, we're leaving as is
        hljsRegister({
            'keyword': "define if cond and or let begin lambda mu quote delay cons-stream set! quasiquote unquote unquote-splicing define-macro"
        });
        hljs.initHighlightingOnLoad();
    </script>
    <script src="/assets/js/dark-mode.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inconsolata|Roboto:300,400,500|Work+Sans:400,700">
    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="stylesheet" href="/assets/css/mono-blue.css">
    <link rel="icon" href="/assets/images/favicon.ico">

    

<link rel="stylesheet" type="text/css" href="/assets/css/disc.css">


    <title>
Discussion 11 | CS 61A Fall 2022
</title>
  </head>

  <body id="index" class="home">
    <nav class="navbar navbar-default navbar-static-top">
      <div class="container noselect">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse-section">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">
            <img style="max-width:60px; margin-top: -20px;" class="logo" src="/assets/images/logo.png"/>
          </a>
        </div>

        <div class="collapse navbar-collapse" id="navbar-collapse-section">
          <ul class="nav navbar-nav navbar-right">
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Calendar
                <span class="caret"></span>
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a href="/weekly">Weekly Schedule</a></li>
                <li><a href="/office-hours">Office Hours</a></li>
              </ul>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Links
                <span class="caret"></span>
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a href="https://go.cs61a.org/lecturezoom">Lecture Zoom Link</a></li>
                <li><a href="https://sections.cs61a.org">Sections Tool</a></li>
                <li><a href="https://oh.cs61a.org">Office Hours Queue</a></li>
              </ul>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Staff
                <span class="caret"></span>
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a href="/instructor">Instructors</a></li>
                <li><a href="/TAs">TAs</a></li>
                <li><a href="/tutors">Tutors</a></li>
                <li><a href="/academic-interns">Academic Interns</a></li>
              </ul>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Resources
                <span class="caret"></span>
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a href="https://go.cs61a.org/extensions">Request an Extension</a></li>
                <li><a href="https://go.cs61a.org/accommodation-appts">Book an Accommodations Appointment</a></li>
                <li><a href="/resources/">Topical Resources + Past Exams</a></li>
                <li><a href="https://tutor.cs61a.org/">PythonTutor</a></li>
                <li><a href="https://code.cs61a.org/">Code</a></li>
                <li><a href="https://edstem.org/us/courses/25379/discussion/" target="_blank">Ed</a></li>
                <li><a href="/articles/campus-res/">Department/Campus Resources</a></li>
              </ul>
            </li>
            <li><a href="/articles/about">Syllabus</a></li>
            <li><a href="/contact/">Contact</a></li>
            <li>
              <label class="switch">
                <input type="checkbox" id="toggle-mode-cb">
                <span class="slider round"></span>
              </label>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <main id="content" class="container">
      
<div class='row'>
  <div class='col-md-9'>
    <header>
      <h1>
        
Discussion 11: Programs as Data

        
        
        <ul class="inline-block list-inline">
          <li><a href="disc11.pdf" class="label label-outline">disc11.pdf</a></li>
        </ul>
        
        
      </h1>
    </header>
    

<div class="alert storable-login-status"></div>

This is an online worksheet that you can work on during discussions.
Your work is not graded and you do not need to submit anything.


    


<!-- <include topics/calculator/introduction.md>  -->
<!-- <include topics/calculator/attributes.md>  -->
<!-- <include topics/calculator/pair-to-calc.md>  -->
<!-- <include topics/calculator/new-op.md>  -->
<!-- <include topics/calculator/new-define.md> -->


<h1 id="programs-as-data">Programs as Data</h1>


<p>So far in Python, we've created functions and expressions that will return a value or an object when we evaluate them.</p>

<pre><code class="python">&gt;&gt;&gt; print(print(5))
5
None
&gt;&gt;&gt; (lambda f, a: f(a))(lambda x: x * x, 3)
9</code></pre>



<p>But what if there was a way to treat our code not as functions or expressions, but rather as data that we can manipulate. For example, imagine if we wanted to write a function in Python that would create and evaluate the following line of code:</p>

<pre><code class="python">[&lt;expr&gt; for i in range(5)]</code></pre>



<p>Where we could pass in any arbitrary expression <code>&lt;expr&gt;</code>,
that would then be evaluated 5 times and have the results listed.</p>

<p>In the example above, <code>&lt;expr&gt;</code> is not necessarily an object, but
could be any piece of code, such as <code>print(&quot;Hello&quot;)</code>, <code>[j ** 2 for j in range(i)]</code>,
or <code>i &gt;= 5</code>. For these expressions it is important to our problem
statement that they not be evaluated until <em>after</em> they have been inserted into
our list comprehension, either because they have side effects that will be apparent
in the global frame, or because they depend on <code>i</code> in some way (there can be
other reasons too!). So, we need a procedure that, instead of manipulating objects,
manipulates code itself!.</p>

<p>Let's see what happens if we try to solve this problem with a traditional function.</p>

<pre><code>def list_5(expr):
	return [expr for i in range(5)]

&gt;&gt;&gt; lst = list_5(print(10))
10
&gt;&gt;&gt; lst
[None, None, None, None, None]</code></pre>



<p>This isn't quite what we want. Because of Python evaluation rules,
instead of evaluating a list of 5 <code>print(10)</code> statements, our <code>expr</code>
was evaluated before the function was ever called, meaning 10 was
only printed once.</p>

<p>The issue here is order of evaluation---we don't want our expression
parameter to be evaluated until <em>after</em> it is inserted into our list
comprehension. To enforce the order of evaluation we want, we can write by returning a <strong>string</strong> representing the return expression, and <strong>evaluating</strong> this string after it has been returned.</p>

<pre><code>def list_5(expr):
	return f&quot;[{expr} for i  in range(5)]&quot;

&gt;&gt;&gt; list_5(&quot;print(10)&quot;)
&quot;[print(10) for i in range(5))]&quot;
&gt;&gt;&gt; lst = eval(list_5(&quot;print(10)&quot;))
10
10
10
10
10
&gt;&gt;&gt; lst
[None, None, None, None, None]</code></pre>



<p>Now we see the number 10 printed 5 times as a side effect of our function, just
like we want! We circumvented Python's evaluate-operands-before-evaluating-function
body rule by passing in our desired expression as a string. Then, after we constructed
our list comprehension in string form and we've returned it, we used the <code>eval</code> function to force evaluation
of the output after the last step in the execution of this
function. We were able to write code that took in code as a parameter and restructured it in the form of new code!</p>

<p>Although this is a cool hack we can do with Python, its usage is unfortunately rather limited.
The <code>eval</code> function will throw a <code>SyntaxError</code> if it is
passed any <code>compound</code> blocks such as <code>if: ...</code>, <code>while: ...</code>,
<code>for: ...</code>, etc. (this does not include list comprehensions, or one-line if-statements
such as <code>1 if  a &gt; b else 0</code>.)</p>


<h3 id="q1-if-program-python">Q1: If Program Python</h3>




<p>Let's see an example of using programs as data that would allow us to circumvent normal python behavior.</p>

<p>Consider this implementation of a function that is supposed to do the same thing as a one-line <code>if</code> statement: <code>[on_true] if [expression] else [on_false]</code></p>

<pre><code class="python">def if_function(condition, true_result, false_result):
    &quot;&quot;&quot;Returns true_result if condition is a true value, and
    false_result otherwise.

    &gt;&gt;&gt; if_function(True, 2, 3)
    2
    &gt;&gt;&gt; if_function(False, 2, 3)
    3
    &quot;&quot;&quot;
    if condition:
        return true_result
    else:
        return false_result</code></pre>



<p>Although our function seems like it would behave as expected, it does not <em>short circuit</em> properly. For example, <code>if_function(True, 2, 1 / 0)</code>, <code>if_function</code> will error since Python first evaluates all the operands before invoking the function. That is, Python will execute the operand <code>1 / 0</code> and error before running the body of <code>if_function</code>.</p>

<p>Ideally, our function should short-circuit before it reaches <code>false_result</code> and only return <code>true_result</code> if <code>condition</code> is evaluated to be truth-y.</p>

<p>To enforce the order of evaluation we want, we can use programs as data! Let's create an alternate function called <code>if_program</code> that takes in three arguments:</p>

<ol>
  <li><code>condition</code>: a string that will evaluate to a truth-y or false-y value</li>
  <li><code>true_result</code>: a string that will be evaluated and returned if <code>condition</code> is truth-y</li>
  <li><code>false_result</code>: a string that will be evaluated and returned if <code>condition</code> is false-y.</li>
</ol>

<p>and returns a <strong>string</strong> that, when evaluated, will return the result of this <code>if</code> function.</p>

<p><code>if_program</code> should <strong>only</strong> evaluate <code>true_result</code> if <code>condition</code> is truth-y, and will only evaluate <code>false_result</code> if <code>condition</code> is false-y.</p>

<blockquote><p><strong>Hint:</strong> You can write a one-line if statement with the following syntax: <code>&lt;value_when_true&gt; if &lt;condition&gt; else &lt;value_when_false&gt;</code></p>

<p><strong>Hint:</strong> Using f-Strings might make this problem easier too!</p></blockquote>


            
            <b>Your Answer</b>
            
            <div class="monaco-storable" id="if-program-python-input" style="height:288px;"></div>
            <a href="javascript:void" id="modal-link-if-program-python-input">Run in 61A Code</a>
            <div class="modal fade" id="modal-if-program-python-input" tabindex="-1" role="dialog">
                <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content" style="padding-bottom: -5px">
                    <iframe
                        id="code-iframe-if-program-python-input"
                        width="100%"
                        height="700px"
                        style="border: none; display:block;"
                    ></iframe>
                    </div>
                </div>
            </div>
            <div class="storable-status"></div>
            <script>
                $(() => activateEditor('def if_program(condition, true_result, false_result):\n    &quot;&quot;&quot;\n    &gt;&gt;&gt; eval(if_program(&quot;True&quot;, &quot;3&quot;, &quot;4&quot;))\n    3\n    &gt;&gt;&gt; eval(if_program(&quot;0&quot;, &quot;&#x27;if true&#x27;&quot;, &quot;&#x27;if false&#x27;&quot;))\n    &#x27;if false&#x27;\n    &gt;&gt;&gt; eval(if_program(&quot;1&quot;, &quot;print(&#x27;true&#x27;)&quot;, &quot;print(&#x27;false&#x27;)&quot;))\n    true\n    &gt;&gt;&gt; eval(if_program(&quot;print(&#x27;condition&#x27;)&quot;, &quot;print(&#x27;true_result&#x27;)&quot;, &quot;print(&#x27;false_result&#x27;)&quot;))\n    condition\n    false_result\n    &quot;&quot;&quot;\n    "*** YOUR CODE HERE ***"\n\n', "python", "if-program-python-input"));
            </script>
        
            <div class="sol-highlight">
                <b>Solution</b>
                
<pre><code>def if_program(condition, true_result, false_result):
    &quot;&quot;&quot;
    &gt;&gt;&gt; eval(if_program(&quot;True&quot;, &quot;3&quot;, &quot;4&quot;))
    3
    &gt;&gt;&gt; eval(if_program(&quot;0&quot;, &quot;&#x27;if true&#x27;&quot;, &quot;&#x27;if false&#x27;&quot;))
    &#x27;if false&#x27;
    &gt;&gt;&gt; eval(if_program(&quot;1&quot;, &quot;print(&#x27;true&#x27;)&quot;, &quot;print(&#x27;false&#x27;)&quot;))
    true
    &gt;&gt;&gt; eval(if_program(&quot;print(&#x27;condition&#x27;)&quot;, &quot;print(&#x27;true_result&#x27;)&quot;, &quot;print(&#x27;false_result&#x27;)&quot;))
    condition
    false_result
    &quot;&quot;&quot;
    return f&quot;{true_result} if {condition} else {false_result}&quot;
</code></pre>

            </div>
        

<div class="page-break"></div>


<h1 id="scheme-programs-as-data">Scheme Programs as Data</h1>


<p>Now let's use Scheme to build programs as data!</p>

<p>Recall that all Scheme programs are made up of expressions.
There are two types of expressions: primitive (a.k.a atomic) expressions and combinations.</p>

<ul>
  <li>Primitive/atomic expression examples: <code>#f</code>, <code>1.7</code>, <code>+</code></li>
  <li>Combinations examples: <code>(factorial 10)</code>, <code>(/ 8 3)</code>, <code>(not #f)</code></li>
</ul>

<p><strong>Importantly, Scheme stores any non-primitive expression as a Scheme list!</strong>
This means we can build lists to represent our programs as data rather than using strings.</p>

<p>For example, <code>(list &#x27;+ 2 2)</code> results in the list <code>(+ 2 2)</code>. If we then call <code>eval</code> on this list, it will be evaluated as a combination <em>expression</em>, which will return <code>4</code>!</p>

<pre><code>scm&gt; (define expr (list &#x27;+ 2 2))
expr
scm&gt; expr
(+ 2 2)
scm&gt; (eval expr)
4</code></pre>



<p>The <code>eval</code> procedure forces evaluation of a given expression in the current
environment. <code>eval</code> takes in one operand. That operand is first evaluated to a value, and then
<code>eval</code> evaluates <em>that</em> value as another expression. In the line <code>(eval expr)</code>, <code>expr</code>
is first evaluated to the list <code>(+ 2 2)</code>, and then <code>eval</code> evaluates that list as an expression to get <code>4</code>.</p>

<p>Since a quote suppresses evaluation, calling <code>eval</code> on a quoted
expression <code>(quote expr)</code> will evaluate the expression <code>expr</code>.</p>

<pre><code class="scheme">scm&gt; (define a &#x27;(1 2 3))
a
scm&gt; (quote a) ; equivalently, &#x27;a
a
scm&gt; (eval (quote a))
(1 2 3)</code></pre>




<h2 id="quasiquotation">Quasiquotation</h2>


<p>The normal quote <code>&#x27;</code> and the quasiquote <code>`</code> are both valid ways to quote an
expression. However, the quasiquoted expression can be <em>unquoted</em> with the
"unquote" <code>,</code> (represented by a comma). When a term in a quasiquoted expression
is <em>unquoted</em>, the unquoted term is <em>evaluated</em>. Quasiquotation will be very helpful for
helping us create lists that represent expressions.</p>

<pre><code class="scheme">scm&gt; (define a 5)
a
scm&gt; (define b 3)
b
scm&gt; `(* a b)
(* a b)
scm&gt; `(* a ,b)
(* a 3)
scm&gt; &#x27;(* a ,b)
(* a (unquote b))</code></pre>



<!-- <include topics/scheme/macros/wwsd-quasiquote-disc.md> -->


<h3 id="q2-writing-quasiquote-expressions">Q2: Writing Quasiquote Expressions</h3>


<p>Given that the following code has been executed in your Scheme environment:</p>

<pre><code class="scheme">scm&gt; (define a +)
a
scm&gt; (define b 1)
b
scm&gt; (define c 2)
c</code></pre>



<p>Write out the expressions <strong>using quasiquote, unquote, a, b, c, and parentheses</strong> to fill in the blanks that would lead to each of the following being displayed:</p>

<p>For example,</p>

<pre><code class="scheme">scm&gt; ___________
(a b c)</code></pre>



<p><strong>Answer:</strong></p>

<pre><code class="scheme">`(a b c)</code></pre>



<p>a) Fill in the following blank:</p>

<pre><code class="scheme">scm&gt; __________________
(a 1 c)</code></pre>



            <label class="sr-only" for="quasiquote-1-input">Your Answer:</label>
            <input class="form-control storable" id="quasiquote-1-input" type="text">
            <div class="storable-status"></div>
        

<div class="sol-highlight">

<pre><code class="scheme">`(a ,b c)</code></pre>


</div>

<p>b) Fill in the following blank:</p>

<pre><code class="scheme">scm&gt; __________________
3</code></pre>



            <label class="sr-only" for="quasiquote-2-input">Your Answer:</label>
            <input class="form-control storable" id="quasiquote-2-input" type="text">
            <div class="storable-status"></div>
        

<div class="sol-highlight">

<pre><code class="scheme">(a b c)</code></pre>


</div>

<p>c) Fill in the following blank:</p>

<pre><code class="scheme">scm&gt; __________________
(a (b 1) c)</code></pre>



            <label class="sr-only" for="quasiquote-3-input">Your Answer:</label>
            <input class="form-control storable" id="quasiquote-3-input" type="text">
            <div class="storable-status"></div>
        

<div class="sol-highlight">

<pre><code class="scheme">`(a (b ,b) c)</code></pre>


</div>

<p>d) Fill in the following blank:</p>

<pre><code class="scheme">scm&gt; __________________
(a 3 c)</code></pre>



            <label class="sr-only" for="quasiquote-4-input">Your Answer:</label>
            <input class="form-control storable" id="quasiquote-4-input" type="text">
            <div class="storable-status"></div>
        

<div class="sol-highlight">

<pre><code class="scheme">`(a ,(a b c) c)</code></pre>


</div>

<p><strong>Additional Practice</strong>
Now, let the following be defined:</p>

<pre><code class="scheme">scm&gt; (define condition &#x27;(= 1 1))
condition
scm&gt; (define if&#x2d;true &#x27;(print 3))
if&#x2d;true
scm&gt; (define if&#x2d;false &#x27;(print 5))
if&#x2d;false</code></pre>



<p>Write the Scheme expression <strong>using the variables condition, if-true, and if-false</strong> along with quasiquoting, that would evaluate to the following:</p>

<pre><code class="scheme">scm&gt; ________________________
(if (= 1 1) (print 3) (print 5))</code></pre>




            <label class="sr-only" for="quasiquote-5-input">Your Answer:</label>
            <input class="form-control storable" id="quasiquote-5-input" type="text">
            <div class="storable-status"></div>
        

<div class="sol-highlight">

<pre><code class="scheme">`(if ,condition ,if&#x2d;true ,if&#x2d;false)</code></pre>


</div>


<h2 id="if-program-scheme">If Program Scheme</h2>



<h3 id="q3-if-program-scheme">Q3: If Program Scheme</h3>




<p>Now let's try writing the <code>if_program</code> Python example using programs as data in Scheme! There are quite a few similarities between Python and Scheme, but we have to make a few adjustments when converting our code over to Scheme. We'll start out by writing a Scheme function with the <code>define</code> form we use for normal functions.</p>

<p>First, let's consider the following questions:</p>

<p>In the Python <code>if_program</code>, we returned a <strong>string</strong> that, when evaluated, would execute an <code>if</code> statement with the correct parameters. In Scheme, we won't return a string, but we'll return something else that can represent an unevaluated expression. What type will we return for Scheme? Here, what "type" refers to the data type: function, list, integer, string, etc..</p>


            <label class="sr-only" for="if-program-disc-1-input">Your Answer:</label>
            <input class="form-control storable" id="if-program-disc-1-input" type="text">
            <div class="storable-status"></div>
        

<div class="sol-highlight">
Scheme List
</div>

<p>In the Python <code>if_program</code>, our operands were all <strong>strings</strong> representing the <code>condition</code>, return value if <code>true</code>, and return value if <code>false</code>. Expressing our operands as strings allowed them to remain unevaluated lines of code. What will each of our operands be in Scheme (i.e. how do we pass in the unevaluated versions of our operand expressions in Scheme)? Give an example of an acceptable operand expression for the <code>condition</code> parameter.</p>


            <label class="sr-only" for="if-program-disc-2-input">Your Answer:</label>
            <input class="form-control storable" id="if-program-disc-2-input" type="text">
            <div class="storable-status"></div>
        

<div class="sol-highlight">
Our operands will be the <em>quoted</em> versions of each of our desired operands. I.e. for condition, we can pass in <code>&#x27;(= 1 1)</code>. Note that the operand <code>&#x27;(= 1 1)</code> will still be evaluated by the Scheme interpreter before being passed into the function (since we're still following normal call expression rules at this point), but the result of evaluating <code>&#x27;(= 1 1)</code> is the list <code>(= 1 1)</code>. So we end up passing in the list <code>(= 1 1)</code> into our function instead of <code>#t</code>. 
</div>

<div class="page-break"></div>

<p>Let's write this out!</p>

<p>Write a function <code>if&#x2d;function</code> using the <code>define</code> form, which will take in the following parameters:</p>

<ol>
  <li><code>condition</code> : a quoted expression which will evaluate to the condition in our if expression</li>
  <li><code>if&#x2d;true</code> : a quoted expression which will evaluate to the value we want to return if true (<code>#t</code>)</li>
  <li><code>if&#x2d;false</code> : a quoted expression which will evaluate to the value we want to return if false (<code>#f</code>)</li>
</ol>

<p>and returns a Scheme list representing the expression that, when evaluated, will evaluate to the result of our <code>if</code> expression.</p>

<p>Here are some doctests to show this:</p>

<pre><code class="scheme">scm&gt; (if&#x2d;program &#x27;(= 0 0) &#x27;2 &#x27;3)
(if (= 0 0) 2 3)
scm&gt; (eval (if&#x2d;program &#x27;(= 0 0) &#x27;2 &#x27;3))
2
scm&gt; (if&#x2d;program &#x27;(= 1 0) &#x27;(print 3) &#x27;(print 5))
(if (= 1 0) (print 3) (print 5))
scm&gt; (eval (if&#x2d;program &#x27;(= 1 0) &#x27;(print 3) &#x27;(print 5)))
5</code></pre>



<blockquote><p><strong>Hint:</strong> You may want to look at your solution to the Additional Practice subproblem of "Writing Quasiquote Expressions"!</p></blockquote>


            
            <b>Your Answer</b>
            
            <div class="monaco-storable" id="if-program-scheme-input" style="height:90px;"></div>
            <a href="javascript:void" id="modal-link-if-program-scheme-input">Run in 61A Code</a>
            <div class="modal fade" id="modal-if-program-scheme-input" tabindex="-1" role="dialog">
                <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content" style="padding-bottom: -5px">
                    <iframe
                        id="code-iframe-if-program-scheme-input"
                        width="100%"
                        height="700px"
                        style="border: none; display:block;"
                    ></iframe>
                    </div>
                </div>
            </div>
            <div class="storable-status"></div>
            <script>
                $(() => activateEditor("(define (if&#x2d;program condition if&#x2d;true if&#x2d;false)\n  'YOUR-CODE-HERE\n)\n", "scheme", "if-program-scheme-input"));
            </script>
        
            <div class="sol-highlight">
                <b>Solution</b>
                
<pre><code>(define (if&#x2d;program condition if&#x2d;true if&#x2d;false)
  `(if ,condition ,if&#x2d;true ,if&#x2d;false)
)</code></pre>

            </div>
        

<p><strong>Note</strong>: We already have a built-in <code>if</code> special form in Scheme that behaves like <code>if&#x2d;program</code>, so this example isn't as exciting, but with this new strategy of treating programs as data we can think about starting to define our <em>own</em> special forms that aren't built into Scheme!</p>


<h2 id="programs-as-data-practice">Programs As Data Practice</h2>

<p>But before we start worrying too much about defining custom special forms, let's practice more with writing procedures that take in, manipulate, and output Scheme expressions as lists!</p>

<p>While doing these problems, remember that quasiquotation is not the only way to create Scheme lists! We also have <code>list</code> and <code>cons</code>. The optimal approach for creating the desired expression as a list depends on the problem.</p>

<div class="page-break"></div>


<h3 id="q4-exponential-powers">Q4: Exponential Powers</h3>




<p>Implement the procedure <code>pow&#x2d;expr</code>, which takes in a base <code>n</code> and a nonnegative integer <code>p</code>. The procedure should create a program as a list that, when passed into the <code>eval</code> procedure, evaluates the value <code>n^p</code>, or <code>n</code> to the <code>p</code>th power.</p>

<p>For example, the expression <code>(pow&#x2d;expr 2 5)</code> returns a program as a list. When <code>eval</code> is called on that returned list, it should evaluate to <code>2^5</code>, which is 32. We'll do this by building nested multiplication expressions!</p>

<pre><code class="scheme">scm&gt; (define expr (pow&#x2d;expr 5 1))
scm&gt; expr
(* 1 5)
scm&gt; (eval expr)
5

scm&gt; (define expr2 (pow&#x2d;expr 5 2))
scm&gt; expr2 
(* (* 1 5) 5)
scm&gt; (eval expr2)
25</code></pre>



<blockquote><p><strong>Hint:</strong> Note that the expression returned by <code>(pow&#x2d;expr 5 2)</code> is just the expression returned by <code>(pow&#x2d;expr 5 1)</code> nested in another multiplication expression. There is an inherent <em>recursive</em> structure here, so what programming paradigm do you think we should use?</p></blockquote>


            
            <b>Your Answer</b>
            
            <div class="monaco-storable" id="pow-input" style="height:108px;"></div>
            <a href="javascript:void" id="modal-link-pow-input">Run in 61A Code</a>
            <div class="modal fade" id="modal-pow-input" tabindex="-1" role="dialog">
                <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content" style="padding-bottom: -5px">
                    <iframe
                        id="code-iframe-pow-input"
                        width="100%"
                        height="700px"
                        style="border: none; display:block;"
                    ></iframe>
                    </div>
                </div>
            </div>
            <div class="storable-status"></div>
            <script>
                $(() => activateEditor("(define (pow&#x2d;expr n p)\n    'YOUR-CODE-HERE\n\n", "scheme", "pow-input"));
            </script>
        
            <div class="sol-highlight">
                <b>Solution</b>
                
<pre><code>(define (pow&#x2d;expr n p)
    (if (= p 0) 1
        `(* ,(pow&#x2d;expr n (&#x2d; p 1)) ,n)))
</code></pre>

            </div>
        

<div class="sol-highlight">
Alternate solution using <code>list</code>:

<pre><code class="scheme">(define (pow&#x2d;expr n p)
    (if (= p 0) 1
        (list &#x27;* (pow&#x2d;expr n (&#x2d; p 1)) n)))</code></pre>


</div>



<h3 id="q5-swap">Q5: Swap</h3>




<p>Implement <code>swap</code>, a procedure which takes a call expression <code>expr</code> and returns the same expression with its first two operands swapped if the value of the second operand is greater than the value of the first. Otherwise, it should just return the original expression.</p>

<p>For example, <code>(swap &#x27;(&#x2d; 1 (+ 3 5) 7))</code> should return the expression <code>(&#x2d; (+ 3 5) 1 7)</code> since <code>1</code> evaluates to <code>1</code>, <code>(+ 3 5)</code> evaluates to <code>8</code>, and <code>8 &gt; 1</code>. Any operands after the first two should not be evaluated during the execution of the procedure, and they should be left unchanged in the final expression. You may assume that every operand evaluates to a number and that there are always at least two operands in <code>expr</code>.</p>

<pre><code class="scheme">scm&gt; (swap &#x27;(&#x2d; 1 (+ 3 5) 7 9))
(&#x2d; (+ 3 5) 1 7 9)

scm&gt; (swap &#x27;(* (+ 1 1) (&#x2d; 2 1)))
(* (+ 1 1) (&#x2d; 2 1))</code></pre>



<p>We have provided a <code>let</code> expression in addition to the provided procedures to help simplify your code.</p>

<!-- Include as disc question -->

            
            <b>Your Answer</b>
            
            <div class="monaco-storable" id="swap-input" style="height:432px;"></div>
            <a href="javascript:void" id="modal-link-swap-input">Run in 61A Code</a>
            <div class="modal fade" id="modal-swap-input" tabindex="-1" role="dialog">
                <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content" style="padding-bottom: -5px">
                    <iframe
                        id="code-iframe-swap-input"
                        width="100%"
                        height="700px"
                        style="border: none; display:block;"
                    ></iframe>
                    </div>
                </div>
            </div>
            <div class="storable-status"></div>
            <script>
                $(() => activateEditor("(define (cddr s)\n  (cdr (cdr s))\n)\n\n(define (cadr s)\n  (car (cdr s))\n)\n\n(define (caddr s)\n  (car (cddr s))\n)\n\n(define (swap expr)\n    (let ((op (car expr))\n        (first (car (cdr expr)))\n        (second (caddr expr))\n        (rest (cdr (cddr expr))))\n        'YOUR-CODE-HERE\n    )\n)\n", "scheme", "swap-input"));
            </script>
        
            <div class="sol-highlight">
                <b>Solution</b>
                
<pre><code>(define (cddr s)
  (cdr (cdr s))
)

(define (cadr s)
  (car (cdr s))
)

(define (caddr s)
  (car (cddr s))
)

(define (swap expr)
    (let ((op (car expr))
        (first (car (cdr expr)))
        (second (caddr expr))
        (rest (cdr (cddr expr))))
        (if (&gt; (eval second) (eval first))
            (cons op (cons second (cons first rest)))
            expr)
    )
)</code></pre>

            </div>
        



<div class="page-break"></div>


<h3 id="q6-make-or">Q6: Make Or</h3>




<p>Implement <code>make&#x2d;or</code>, which returns, as a list, a program that takes in two expressions and <code>or</code>'s them together (applying short-circuiting rules). However, do this without using the <code>or</code> special form. You may also assume the name <code>v1</code> doesn't appear anywhere outside this function. For a quick reminder on the short-circuiting rules for <code>or</code> take a look at slide 18 of <a href="/assets/slides/03-Control_4pp.pdf">Lecture 3 on Control</a>.</p>

<p>The behavior of the <code>or</code> procedure is specified by the following doctests:</p>

<pre><code class="scheme">scm&gt; (define or&#x2d;program (make&#x2d;or &#x27;(print &#x27;bork) &#x27;(/ 1 0)))
or&#x2d;program
scm&gt; (eval or&#x2d;program)
bork
scm&gt; (eval (make&#x2d;or &#x27;(= 1 0) &#x27;(+ 1 2)))
3</code></pre>



<p>As a starting point, consider this <strong><em>incorrect</em></strong> implementation:</p>

<pre><code class="scheme">scm&gt; (define (make&#x2d;or expr1 expr2) `(if ,expr1 ,expr1 ,expr2)))</code></pre>



<p>This incorrect implementation would result in the following incorrect behavior:</p>

<pre><code class="scheme">scm&gt; (make&#x2d;or &#x27;(print &#x27;bork) &#x27;(/ 1 0))
(if (print (quote bork)) (print (quote bork)) (/ 1 0))
scm&gt; (eval (make&#x2d;or &#x27;(print &#x27;bork) &#x27;(/ 1 0)))
bork
bork</code></pre>



<p>Although there is short-circuiting behavior, notice that <code>(print (quote bork))</code> is evaluated twice, once when evaluating the <code>&lt;predicate&gt;</code> expression and another time when evaluating the <code>&lt;if&#x2d;true&gt;</code> expression. Consider how we can get around this using the <code>let</code> special form.</p>


            
            <b>Your Answer</b>
            
            <div class="monaco-storable" id="or-macro-input" style="height:108px;"></div>
            <a href="javascript:void" id="modal-link-or-macro-input">Run in 61A Code</a>
            <div class="modal fade" id="modal-or-macro-input" tabindex="-1" role="dialog">
                <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content" style="padding-bottom: -5px">
                    <iframe
                        id="code-iframe-or-macro-input"
                        width="100%"
                        height="700px"
                        style="border: none; display:block;"
                    ></iframe>
                    </div>
                </div>
            </div>
            <div class="storable-status"></div>
            <script>
                $(() => activateEditor('(define (make&#x2d;or expr1 expr2)\n    `(let ((v1 ____________))\n        (if _____ _____ _____))\n)\n', "scheme", "or-macro-input"));
            </script>
        
            <div class="sol-highlight">
                <b>Solution</b>
                
<pre><code>(define (make&#x2d;or expr1 expr2)
    `(let ((v1 ,expr1))
        (if v1 v1 ,expr2))
)</code></pre>

            </div>
        

</p>

<div class="page-break"></div>


<h3 id="q7-make-make-or">Q7: Make "Make Or"</h3>




<p>The above code generates a program that evaluates an <code>or</code> expression without using any <code>or</code> statements. However, we can take it even one step further: let's create a program which generates <code>make&#x2d;or</code>, the program you created which generates an <code>or</code> expression.</p>

<p>Implement <code>make&#x2d;make&#x2d;or</code>, a program which generates a program which, when <code>eval</code>'d, can be <code>apply</code>'d to make an <code>or</code> expression with differing variables. You may find the code you wrote above to be useful.</p>

<blockquote><p>Hint: recall that you want to construct a list that resembles the program. Do you know what this list would look like?</p></blockquote>


            
            <b>Your Answer</b>
            
            <div class="monaco-storable" id="make-or-input" style="height:90px;"></div>
            <a href="javascript:void" id="modal-link-make-or-input">Run in 61A Code</a>
            <div class="modal fade" id="modal-make-or-input" tabindex="-1" role="dialog">
                <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content" style="padding-bottom: -5px">
                    <iframe
                        id="code-iframe-make-or-input"
                        width="100%"
                        height="700px"
                        style="border: none; display:block;"
                    ></iframe>
                    </div>
                </div>
            </div>
            <div class="storable-status"></div>
            <script>
                $(() => activateEditor("(define (make&#x2d;make&#x2d;or)\n  'YOUR-CODE-HERE\n)\n", "scheme", "make-or-input"));
            </script>
        
            <div class="sol-highlight">
                <b>Solution</b>
                
<pre><code>(define (make&#x2d;make&#x2d;or)
  &#x27;(define (make&#x2d;or expr1 expr2) `(let ((v1 ,expr1)) (if v1 v1 ,expr2)))
)</code></pre>

            </div>
        

<p>Now, given this function, determine the outputs from the following expressions:</p>

<pre><code class="scheme">scm&gt; (make&#x2d;make&#x2d;or)</code></pre>




            <label class="sr-only" for="wwsd-m-or-1-input">Your Answer:</label>
            <input class="form-control storable" id="wwsd-m-or-1-input" type="text">
            <div class="storable-status"></div>
        
<div class="sol-highlight">
(define (make-or expr1 expr2) (quasiquote (let ((v1 (unquote expr1))) (if v1 v1 (unquote expr2)))))
</div>

<pre><code class="scheme">scm&gt; (eval (make&#x2d;make&#x2d;or))</code></pre>




            <label class="sr-only" for="wwsd-m-or-2-input">Your Answer:</label>
            <input class="form-control storable" id="wwsd-m-or-2-input" type="text">
            <div class="storable-status"></div>
        
<div class="sol-highlight">
make-or
</div>

<pre><code class="scheme">scm&gt; (eval (eval (make&#x2d;make&#x2d;or)))</code></pre>




            <label class="sr-only" for="wwsd-m-or-3-input">Your Answer:</label>
            <input class="form-control storable" id="wwsd-m-or-3-input" type="text">
            <div class="storable-status"></div>
        
<div class="sol-highlight">
(lambda (expr1 expr2) (quasiquote (let ((v1 (unquote expr1))) (if v1 v1 (unquote expr2)))))
</div>

<pre><code class="scheme">scm&gt; (apply (eval (eval (make&#x2d;make&#x2d;or))) &#x27;(#t (/ 1 0)))</code></pre>




            <label class="sr-only" for="wwsd-m-or-4-input">Your Answer:</label>
            <input class="form-control storable" id="wwsd-m-or-4-input" type="text">
            <div class="storable-status"></div>
        
<div class="sol-highlight">
(let ((v1 #t)) (if v1 v1 (/ 1 0)))
</div>

<pre><code class="scheme">scm&gt; (eval (apply (eval (eval (make&#x2d;make&#x2d;or))) &#x27;(#t (/ 1 0))))</code></pre>




            <label class="sr-only" for="wwsd-m-or-5-input">Your Answer:</label>
            <input class="form-control storable" id="wwsd-m-or-5-input" type="text">
            <div class="storable-status"></div>
        
<div class="sol-highlight">
#t
</div>

  </div>

  <div class='col-md-3 sticky'>
    <nav class='hidden-print hidden-sm hidden-xs sidebar'>
      <ul>
  <li><a href="#programs-as-data">Programs as Data</a></li>
  <ul>
    <li><a href="#q1-if-program-python">Q1: If Program Python</a></li>
  </ul>
  <li><a href="#scheme-programs-as-data">Scheme Programs as Data</a></li>
  <ul>
    <li><a href="#quasiquotation">Quasiquotation</a></li>
    <ul>
      <li><a href="#q2-writing-quasiquote-expressions">Q2: Writing Quasiquote Expressions</a></li>
    </ul>
    <li><a href="#if-program-scheme">If Program Scheme</a></li>
    <ul>
      <li><a href="#q3-if-program-scheme">Q3: If Program Scheme</a></li>
    </ul>
    <li><a href="#programs-as-data-practice">Programs As Data Practice</a></li>
    <ul>
      <li><a href="#q4-exponential-powers">Q4: Exponential Powers</a></li>
      <li><a href="#q5-swap">Q5: Swap</a></li>
      <li><a href="#q6-make-or">Q6: Make Or</a></li>
      <li><a href="#q7-make-make-or">Q7: Make "Make Or"</a></li>
    </ul>
  </ul>
</ul>
    </nav>
  </div>
</div>

    </main>

    <footer class="container">
      <div class="row text-center">
        <div class="col col-sm-4">
          <h3><a href="/">CS 61A</a></h3>
          <ul class="nav nav-pills nav-stacked">
            <li><a href="/weekly">Weekly Schedule</a></li>
            <li><a href="/office-hours">Office Hours</a></li>
            <li><a href="/staff">Staff</a></li>
          </ul>
        </div>
        <div class="col col-sm-4">
          <h3><a href="/resources">Resources</a></h3>
          <ul class="nav nav-pills nav-stacked">
            <li><a href="/articles/studying">Studying Guide</a></li>
            <li><a href="/articles/debugging">Debugging Guide</a></li>
            <li><a href="/articles/composition">Composition Guide</a></li>
            <li><a href="/articles/pair-programming">Pair Programming</a></li>
          </ul>
        </div>
        <div class="col col-sm-4">
          <h3><a href="/articles/about">Policies</a></h3>
          <ul class="nav nav-pills nav-stacked">
            <li><a href="/articles/about#assignments">Assignments</a></li>
            <li><a href="/articles/about#exams">Exams</a></li>
            <li><a href="/articles/about#grading">Grading</a></li>
          </ul>
        </div>
      </div>
    </footer>

    

    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min/vs/loader.min.js"></script>
  <link rel="stylesheet" data-name="vs/editor/editor.main" href="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min/vs/editor/editor.main.min.css">
  <script>
      require.config({ paths: { 'vs': 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min/vs' }});
      window.MonacoEnvironment = { getWorkerUrl: () => URL.createObjectURL(new Blob([`
      self.MonacoEnvironment = {
          baseUrl: 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min'
      };
      importScripts('https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min/vs/base/worker/workerMain.min.js');
  `], { type: 'text/javascript' }))
  };
  </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsPlumb/2.15.5/js/jsplumb.min.js"></script>
    <script src="/assets/js/network_storage.js"></script>
    <script src="/assets/js/storable.js"></script>
    <script src="/assets/js/editor.js"></script>
    <script src="/assets/js/copy-button.js"></script>
    <script src="/assets/js/env-diagram.js"></script>
    
<script src="/assets/js/sketchy.js"></script>
<script>
  $('.sidebar ul').addClass('nav nav-stacked noselect');
  $('body').scrollspy({
    target: '.sidebar',
    offset: 40
  });

  function goToId(id) {
    var target = $(id);
    target.parent().show();
    $('html,body').animate({
      scrollTop: target.offset().top,
    }, 100);
    $("body").scrollspy('refresh');
  }

  if (location.hash) {
    setTimeout(function() {
      if (location.hash) {
        goToId(location.hash);
      }
    }, 1);
  }

  $("a").click(function(event) {
    var urlBeforeHashRegEx = new RegExp("^"+window.location.href.split("#")[0]);
    if (/^#/.test(this.hash) && urlBeforeHashRegEx.test(this.href)) {
      event.preventDefault();
      goToId(this.hash);
      document.location.hash = this.hash;
    }
  });
</script>

  </body>
</html>